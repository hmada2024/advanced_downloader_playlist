ADVANCED_DOWNLOADER/          <-- المجلد الجذر للمشروع
├── .venv/                    <-- مجلد البيئة الافتراضية (عادة لا يتم تتبعه بواسطة Git)
├── assets/                   <-- (اختياري) مجلد للأيقونات أو الصور الأخرى
│   └── logo.ico              <-- مثال: أيقونة التطبيق
├── ffmpeg_bin/               <-- مجلد يحتوي على ملفات FFmpeg التنفيذية
│   ├── ffmpeg.exe
│   └── ffprobe.exe
├── src/                      <-- المجلد الرئيسي لكود المصدر
│   ├── __init__.py           <-- ملف فارغ لجعل src حزمة بايثون
│   │
│   ├── ui/                   <-- مجلد الواجهة الرسومية (GUI)
│   │   ├── __init__.py       <-- ملف فارغ لجعل ui حزمة فرعية
│   │   ├── interface.py      <-- الكلاس الرئيسي لنافذة التطبيق والتبويبات (يحتوي على UserInterface)
│   │   ├── action_handler.py <-- Mixin لمعالجة أفعال المستخدم (ضغطات الأزرار)
│   │   ├── callback_handler.py<- Mixin لمعالجة الاستدعاءات الراجعة من طبقة المنطق
│   │   ├── state_manager.py  <-- Mixin لإدارة حالات الواجهة المختلفة (idle, fetching, downloading)
│   │   │
│   │   └── components/       <-- مجلد فرعي لمكونات الواجهة المستقلة
│   │       ├── __init__.py   <-- ملف فارغ لجعل components حزمة فرعية
│   │       ├── bottom_controls_frame.py <-- إطار أزرار التحكم السفلية (Download/Cancel)
│   │       ├── options_control_frame.py <-- إطار خيارات التنسيق ومفتاح قائمة التشغيل
│   │       ├── path_selection_frame.py  <-- إطار اختيار مسار الحفظ
│   │       ├── playlist_selector.py     <-- إطار عرض واختيار عناصر قائمة التشغيل
│   │       └── top_input_frame.py       <-- إطار حقل إدخال الرابط وزر الجلب
│   │
│   └── logic/                <-- مجلد المنطق الخلفي (Backend Logic)
│       ├── __init__.py       <-- ملف فارغ لجعل logic حزمة فرعية
│       ├── logic_handler.py  <-- الكلاس المنسق الرئيسي لعمليات المنطق (يربط الواجهة بالخلفية)
│       ├── info_fetcher.py   <-- الكلاس المسؤول عن جلب معلومات الفيديو/القائمة
│       ├── downloader.py     <-- الكلاس المنسق الرئيسي لعملية التحميل
│       ├── downloader_constants.py <-- الثوابت المستخدمة في عملية التحميل (رسائل الحالة، أسماء المعالجات، إلخ)
│       ├── downloader_hooks.py <-- الكلاسات لمعالجة progress/postprocessor hooks من yt-dlp
│       ├── downloader_utils.py <-- دوال مساعدة خاصة بعملية التحميل (بناء الصيغة، إلخ)
│       ├── utils.py          <-- دوال مساعدة عامة للمنطق (مثل find_ffmpeg, clean_filename)
│       ├── exceptions.py     <-- تعريف الاستثناءات المخصصة (مثل DownloadCancelled)
│       └── history_manager.py <-- (مستقبلي) كلاس لإدارة سجل التحميل
│
├── .gitignore                <-- ملف لتحديد الملفات التي يتجاهلها Git (مثل .venv, __pycache__)
├── main.py                   <-- ملف نقطة الدخول الرئيسي لتشغيل التطبيق (الآن في الجذر)
├── requirements.txt          <-- قائمة بالمكتبات الخارجية المطلوبة (customtkinter, yt-dlp, humanize)
├── README.md                 <-- (مقترح) ملف لوضع ملخص المشروع والمعلومات الأخرى
└── advanced_downloaderV4.spec <-- (مثال) ملف مواصفات PyInstaller للتجميع

ملخص مهام ملفات مشروع Advanced Spider Fetch
=========================================

**ملفات الجذر:**
*   `main.py`: نقطة الدخول الرئيسية لتشغيل التطبيق. يقوم بتهيئة الواجهة (UserInterface) ومنسق المنطق (LogicHandler) ويربطهما ببعضهما، ثم يبدأ حلقة الأحداث الرئيسية للتطبيق.
*   `requirements.txt`: يسرد مكتبات بايثون الخارجية التي يعتمد عليها المشروع (مثل customtkinter, yt-dlp, humanize) ليتم تثبيتها باستخدام `pip install -r requirements.txt`.
*   `README.md` (هذا الملف): يوفر نظرة عامة على المشروع، هيكله، كيفية الإعداد والتشغيل.
*   `.gitignore`: يخبر نظام التحكم في الإصدارات Git بتجاهل ملفات ومجلدات معينة (مثل البيئة الافتراضية `venv`, مجلدات الكاش `__pycache__`, مجلدات التجميع `build`/`dist`).
*   `advanced_downloader*.spec`: ملفات التكوين التي يستخدمها PyInstaller لتجميع التطبيق في ملف تنفيذي مستقل لويندوز.

**مجلد `src/` (الكود المصدري):**
*   `src/__init__.py`: يجعل مجلد `src` قابلاً للاستيراد كحزمة بايثون.

**مجلد `src/ui/` (الواجهة الرسومية):**
*   `ui/__init__.py`: يجعل مجلد `ui` حزمة فرعية.
*   `ui/interface.py`: يحتوي على الكلاس الرئيسي `UserInterface` الذي يمثل نافذة التطبيق. يرث من `ctk.CTk` ومن الـ Mixins الأخرى، وينسق بين مكونات الواجهة المختلفة.
*   `ui/action_handler.py`: كلاس Mixin يحتوي على الدوال التي يتم استدعاؤها عند تفاعل المستخدم مع الواجهة (مثل الضغط على زر "Fetch Info" أو "Download"). هذه الدوال تبدأ العمليات في طبقة المنطق.
*   `ui/callback_handler.py`: كلاس Mixin يحتوي على الدوال التي يتم استدعاؤها بواسطة طبقة المنطق (عادة من خيط منفصل) لإبلاغ الواجهة بنتائج العمليات (مثل نجاح جلب المعلومات، تحديث شريط التقدم، انتهاء التحميل، أو حدوث خطأ).
*   `ui/state_manager.py`: كلاس Mixin مسؤول عن إدارة وتغيير حالة الواجهة المرئية (تمكين/تعطيل الأزرار والحقول، تغيير نصوص الأزرار، إظهار/إخفاء محدد قائمة التشغيل) بناءً على ما يحدث في التطبيق (خامل، يجلب معلومات، يحمل، إلخ).

**مجلد `src/ui/components/` (مكونات الواجهة):**
*   `components/__init__.py`: يجعل مجلد `components` حزمة فرعية.
*   (كل ملف `.py` هنا يمثل قطعة مستقلة وقابلة لإعادة الاستخدام من الواجهة)
*   `components/top_input_frame.py`: الإطار العلوي الذي يحتوي على حقل إدخال الرابط وزر "Fetch Info".
*   `components/options_control_frame.py`: الإطار الذي يحتوي على قائمة اختيار تنسيق/جودة التحميل ومفتاح التبديل لوضع قائمة التشغيل.
*   `components/path_selection_frame.py`: الإطار الذي يحتوي على حقل عرض مسار الحفظ وزر "Browse" لاختيار المجلد.
*   `components/playlist_selector.py`: الإطار القابل للتمرير الذي يعرض عناصر قائمة التشغيل (إذا تم جلبها) ويتيح للمستخدم تحديد العناصر المراد تحميلها.
*   `components/bottom_controls_frame.py`: الإطار السفلي الذي يحتوي على زر "Download" وزر "Cancel".

**مجلد `src/logic/` (منطق التطبيق):**
*   `logic/__init__.py`: يجعل مجلد `logic` حزمة فرعية.
*   `logic/logic_handler.py`: الكلاس المنسق لطبقة المنطق. يعمل كوسيط بين الواجهة وعمليات الخلفية الفعلية (جلب المعلومات والتحميل). يدير الخيوط (threads) وإشارات الإلغاء.
*   `logic/info_fetcher.py`: الكلاس المتخصص في استخدام مكتبة `yt-dlp` لجلب البيانات الوصفية (metadata) للفيديو أو قائمة التشغيل من الرابط المُدخل. يعمل في خيط منفصل.
*   `logic/downloader.py`: الكلاس المتخصص في استخدام مكتبة `yt-dlp` لتنفيذ عملية التحميل والمعالجة اللاحقة (مثل الدمج أو تحويل الصيغة) بناءً على خيارات المستخدم. يعمل في خيط منفصل.
*   `logic/downloader_constants.py`: يحتوي على قيم ثابتة (constants) مستخدمة بشكل متكرر في عملية التحميل، مثل نصوص رسائل الحالة المختلفة وأسماء معالجات `yt-dlp` الداخلية وامتدادات الملفات.
*   `logic/downloader_hooks.py`: يحتوي على الكلاسات التي تُمرر إلى `yt-dlp` كـ "hooks" لمراقبة تقدم التحميل (`ProgressHookHandler`) ومراحل المعالجة اللاحقة (`PostprocessorHookHandler`) وتحديث الواجهة بناءً عليها.
*   `logic/downloader_utils.py`: يحتوي على دوال مساعدة خاصة بعملية التحميل، مثل بناء سلسلة تنسيق التحميل المعقدة لـ `yt-dlp` والتحقق من طلب الإلغاء.
*   `logic/utils.py`: يحتوي على دوال مساعدة عامة يمكن استخدامها في أجزاء مختلفة من طبقة المنطق، مثل دالة البحث عن `ffmpeg.exe` ودالة تنظيف أسماء الملفات من الأحرف غير الصالحة.
*   `logic/exceptions.py`: يعرف فئات الاستثناءات (الأخطاء) المخصصة التي يستخدمها التطبيق، مثل `DownloadCancelled` للإشارة إلى أن المستخدم ألغى عملية ما.
*   `logic/history_manager.py`: (ملف هيكلي حاليًا) سيكون مسؤولاً عن التفاعل مع قاعدة بيانات أو ملف لتخزين وإدارة سجل التحميلات السابقة (ميزة مستقبلية).

**مجلدات أخرى:**
*   `ffmpeg_bin/`: يجب أن يحتوي على ملفي `ffmpeg.exe` و `ffprobe.exe` اللازمين لعمليات معالجة الفيديو والصوت المتقدمة التي تقوم بها `yt-dlp` (مثل الدمج وتحويل MP3).
*   `assets/`: لتخزين الملفات الإضافية مثل أيقونة التطبيق.
*   `.venv/`: البيئة الافتراضية لبايثون لعزل تبعيات المشروع.
