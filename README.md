
Advanced Spider Fetch
=========================================

**ملفات الجذر:**
*   `main.py`: نقطة الدخول الرئيسية لتشغيل التطبيق. يقوم بتهيئة الواجهة (UserInterface) ومنسق المنطق (LogicHandler) ويربطهما ببعضهما، ثم يبدأ حلقة الأحداث الرئيسية للتطبيق.
*   `requirements.txt`: يسرد مكتبات بايثون الخارجية التي يعتمد عليها المشروع (مثل customtkinter, yt-dlp, humanize) ليتم تثبيتها باستخدام `pip install -r requirements.txt`.
*   `README.md` (هذا الملف): يوفر نظرة عامة على المشروع، هيكله، كيفية الإعداد والتشغيل.
*   `.gitignore`: يخبر نظام التحكم في الإصدارات Git بتجاهل ملفات ومجلدات معينة (مثل البيئة الافتراضية `venv`, مجلدات الكاش `__pycache__`, مجلدات التجميع `build`/`dist`).
*   `advanced_downloader*.spec`: ملفات التكوين التي يستخدمها PyInstaller لتجميع التطبيق في ملف تنفيذي مستقل لويندوز.

**مجلد `src/` (الكود المصدري):**
*   `src/__init__.py`: يجعل مجلد `src` قابلاً للاستيراد كحزمة بايثون.

**مجلد `src/ui/` (الواجهة الرسومية):**
*   `ui/__init__.py`: يجعل مجلد `ui` حزمة فرعية.
*   `ui/interface.py`: يحتوي على الكلاس الرئيسي `UserInterface` الذي يمثل نافذة التطبيق. يرث من `ctk.CTk` ومن الـ Mixins الأخرى، وينسق بين مكونات الواجهة المختلفة.
*   `ui/action_handler.py`: كلاس Mixin يحتوي على الدوال التي يتم استدعاؤها عند تفاعل المستخدم مع الواجهة (مثل الضغط على زر "Fetch Info" أو "Download"). هذه الدوال تبدأ العمليات في طبقة المنطق.
*   `ui/callback_handler.py`: كلاس Mixin يحتوي على الدوال التي يتم استدعاؤها بواسطة طبقة المنطق (عادة من خيط منفصل) لإبلاغ الواجهة بنتائج العمليات (مثل نجاح جلب المعلومات، تحديث شريط التقدم، انتهاء التحميل، أو حدوث خطأ).
*   `ui/state_manager.py`: كلاس Mixin مسؤول عن إدارة وتغيير حالة الواجهة المرئية (تمكين/تعطيل الأزرار والحقول، تغيير نصوص الأزرار، إظهار/إخفاء محدد قائمة التشغيل) بناءً على ما يحدث في التطبيق (خامل، يجلب معلومات، يحمل، إلخ).

**مجلد `src/ui/components/` (مكونات الواجهة):**
*   `components/__init__.py`: يجعل مجلد `components` حزمة فرعية.
*   (كل ملف `.py` هنا يمثل قطعة مستقلة وقابلة لإعادة الاستخدام من الواجهة)
*   `components/top_input_frame.py`: الإطار العلوي الذي يحتوي على حقل إدخال الرابط وزر "Fetch Info".
*   `components/options_control_frame.py`: الإطار الذي يحتوي على قائمة اختيار تنسيق/جودة التحميل ومفتاح التبديل لوضع قائمة التشغيل.
*   `components/path_selection_frame.py`: الإطار الذي يحتوي على حقل عرض مسار الحفظ وزر "Browse" لاختيار المجلد.
*   `components/playlist_selector.py`: الإطار القابل للتمرير الذي يعرض عناصر قائمة التشغيل (إذا تم جلبها) ويتيح للمستخدم تحديد العناصر المراد تحميلها.
*   `components/bottom_controls_frame.py`: الإطار السفلي الذي يحتوي على زر "Download" وزر "Cancel".

**مجلد `src/logic/` (منطق التطبيق):**
*   `logic/__init__.py`: يجعل مجلد `logic` حزمة فرعية.
*   `logic/logic_handler.py`: الكلاس المنسق لطبقة المنطق. يعمل كوسيط بين الواجهة وعمليات الخلفية الفعلية (جلب المعلومات والتحميل). يدير الخيوط (threads) وإشارات الإلغاء.
*   `logic/info_fetcher.py`: الكلاس المتخصص في استخدام مكتبة `yt-dlp` لجلب البيانات الوصفية (metadata) للفيديو أو قائمة التشغيل من الرابط المُدخل. يعمل في خيط منفصل.
*   `logic/downloader.py`: الكلاس المتخصص في استخدام مكتبة `yt-dlp` لتنفيذ عملية التحميل والمعالجة اللاحقة (مثل الدمج أو تحويل الصيغة) بناءً على خيارات المستخدم. يعمل في خيط منفصل.
*   `logic/downloader_constants.py`: يحتوي على قيم ثابتة (constants) مستخدمة بشكل متكرر في عملية التحميل، مثل نصوص رسائل الحالة المختلفة وأسماء معالجات `yt-dlp` الداخلية وامتدادات الملفات.
*   `logic/downloader_hooks.py`: يحتوي على الكلاسات التي تُمرر إلى `yt-dlp` كـ "hooks" لمراقبة تقدم التحميل (`ProgressHookHandler`) ومراحل المعالجة اللاحقة (`PostprocessorHookHandler`) وتحديث الواجهة بناءً عليها.
*   `logic/downloader_utils.py`: يحتوي على دوال مساعدة خاصة بعملية التحميل، مثل بناء سلسلة تنسيق التحميل المعقدة لـ `yt-dlp` والتحقق من طلب الإلغاء.
*   `logic/utils.py`: يحتوي على دوال مساعدة عامة يمكن استخدامها في أجزاء مختلفة من طبقة المنطق، مثل دالة البحث عن `ffmpeg.exe` ودالة تنظيف أسماء الملفات من الأحرف غير الصالحة.
*   `logic/exceptions.py`: يعرف فئات الاستثناءات (الأخطاء) المخصصة التي يستخدمها التطبيق، مثل `DownloadCancelled` للإشارة إلى أن المستخدم ألغى عملية ما.
*   `logic/history_manager.py`: (ملف هيكلي حاليًا) سيكون مسؤولاً عن التفاعل مع قاعدة بيانات أو ملف لتخزين وإدارة سجل التحميلات السابقة (ميزة مستقبلية).

**مجلدات أخرى:**
*   `ffmpeg_bin/`: يجب أن يحتوي على ملفي `ffmpeg.exe` و `ffprobe.exe` اللازمين لعمليات معالجة الفيديو والصوت المتقدمة التي تقوم بها `yt-dlp` (مثل الدمج وتحويل MP3).
*   `assets/`: لتخزين الملفات الإضافية مثل أيقونة التطبيق.
*   `.venv/`: البيئة الافتراضية لبايثون لعزل تبعيات المشروع.
